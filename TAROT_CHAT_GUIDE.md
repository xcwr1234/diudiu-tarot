# 对话式塔罗占卜 - 使用指南

## 📖 功能概述

我们全新推出了**对话式塔罗占卜**功能！这是一个革命性的占卜体验，让您可以像与真正的塔罗师对话一样，获得深度的、个性化的指引。

### 🌟 两种占卜模式

访问 `/tarot` 页面时，您现在可以选择：

#### 1. 💬 对话式占卜（推荐）
- 与AI塔罗师"月影"进行一对一对话
- 自然的交流体验，像真实的塔罗咨询
- 深度挖掘问题本质
- 智能推荐合适的牌组和牌阵
- 逐步揭示牌面含义
- 个性化情感支持和指导

#### 2. ⚡ 快速占卜
- 传统的表单式占卜
- 直接选择牌组和牌阵
- 适合有经验的用户
- 快速获得结果

## 🎯 对话式占卜流程

### 阶段1: 欢迎与建立连接
- 塔罗师月影会温暖地问候您
- 询问您今天来访的原因
- 您可以自由分享您的感受、困惑或问题

### 阶段2: 问题探索（2-4轮对话）
- 塔罗师会耐心倾听您的问题
- 通过温和的提问帮助您更清晰地表达
- 理解您的情感背景和真实需求
- 分析问题类型（感情/事业/决策等）

### 阶段3: 占卜确认
- 基于对话，塔罗师会推荐最适合您的：
  - **牌组**（马赛/维特/透特/黄金黎明）
  - **牌阵**（三牌时间流/凯尔特十字等）
- 您可以确认或要求调整

### 阶段4: 牌面揭示
- 逐张揭示塔罗牌
- 每张牌都会结合您的问题深度解读
- 可以看到牌的正逆位和具体含义
- 所有已揭示的牌会显示在侧边栏

### 阶段5: 综合解读与互动
- 所有牌揭示后，提供整体解读
- 您可以继续提问、寻求更多指导
- 塔罗师会回答您的疑问
- 提供实用的建议和情感支持

### 阶段6: 结束与祝福
- 温暖的结束语和祝福
- 可以选择开始新的占卜

## 💡 使用建议

### 初次使用者
- 选择**对话式占卜**，获得完整的咨询体验
- 不要担心不知道如何表达，塔罗师会引导您
- 放松心情，真诚地分享您的感受

### 经验用户
- 如果明确知道想要什么，可以选择**快速占卜**
- 对话模式也适合想要深度探索的情况
- 可以随时在两种模式间切换

## 🔧 技术实现

### 核心文件

```
shipany-template-one-main/
├── src/
│   ├── components/
│   │   └── blocks/
│   │       ├── tarot-chat/          # 对话界面组件
│   │       │   └── index.tsx
│   │       ├── tarot-mode-selector/  # 模式选择组件
│   │       │   └── index.tsx
│   │       └── tarot/                # 快速占卜组件
│   │           └── index.tsx
│   ├── app/
│   │   ├── api/
│   │   │   └── tarot/
│   │   │       └── chat/             # 对话API端点
│   │   │           └── route.ts
│   │   └── [locale]/
│   │       └── (default)/
│   │           └── tarot/            # 占卜页面
│   │               └── page.tsx
│   └── services/
│       └── tarot-analysis.ts         # 问题分析服务
```

### 对话状态机

```typescript
type Phase = 
  | "welcome"       // 欢迎
  | "exploration"   // 探索
  | "confirmation"  // 确认
  | "reading"       // 占卜
  | "interpretation"// 解读
  | "conclusion";   // 结束
```

### API接口

#### POST `/api/tarot/chat`

**请求体：**
```json
{
  "message": "用户消息",
  "conversationHistory": [
    { "role": "user", "content": "..." },
    { "role": "assistant", "content": "..." }
  ],
  "conversationState": {
    "phase": "exploration",
    "userQuestion": "...",
    "suggestedDeck": "waite",
    "suggestedSpread": "three_card_time"
  },
  "language": "zh"
}
```

**响应：**
```json
{
  "code": 0,
  "data": {
    "message": "塔罗师的回复",
    "newState": {
      "phase": "reading",
      "cardsDrawn": [...],
      "currentCardIndex": 0
    },
    "metadata": {
      "cardRevealed": {...},
      "position": "过去"
    }
  }
}
```

## 🎨 界面特性

### 聊天界面
- 类似即时通讯应用的对话体验
- 塔罗师和用户头像区分
- 平滑的消息动画效果
- 实时加载状态指示

### 牌面展示
- 揭示的牌显示在消息中
- 侧边栏展示所有已揭示的牌
- 精美的卡片动画效果
- 正逆位清晰标注

### 阶段提示
- 顶部显示当前对话阶段
- 欢迎/探索/确认/占卜/解读/结束
- 帮助用户了解占卜进度

## 🌐 国际化支持

完整支持中英文：
- 中文（zh）
- English (en)

界面会根据浏览器语言自动切换，也可以手动选择。

## 🤖 AI集成

使用 DeepSeek AI 提供智能对话：
- 温暖、专业的塔罗师角色
- 深度共情和理解能力
- 心理洞察和情感支持
- 个性化的解读和建议

### 环境变量配置

确保 `.env` 文件中设置了：
```bash
DEEPSEEK_API_KEY=your_api_key_here
```

## 📝 示例对话流程

```
塔罗师：✨ 你好，亲爱的朋友。我是月影，你的塔罗导师。
        欢迎来到这个神圣的空间...
        今天是什么带你来到我这里？

用户：   我最近在工作上遇到了一些困惑，不知道该如何选择。

塔罗师：我能感受到你内心的迷茫。工作选择确实是人生中的重要决定...
        能告诉我更多吗？是关于职业发展方向，还是具体的工作机会？

用户：   是关于两个工作机会的选择...

塔罗师：我理解了。让我为你推荐"维特塔罗"配合"选择对比阵"...
        这个组合非常适合分析两个选择的优劣。你觉得如何？

用户：   好的，开始吧。

塔罗师：✨ 很好。现在，让我们开始这次神圣的占卜之旅...
        
        [揭示第一张牌]
        在"选择A-优势"的位置，我为你抽到了"魔术师"（正位）...
```

## 🚀 未来扩展

可能的功能增强：
- [ ] 语音输入支持
- [ ] 占卜历史记录
- [ ] 分享占卜结果
- [ ] 牌面图片展示
- [ ] 更多牌组和牌阵
- [ ] 占卜报告导出

## ⚠️ 注意事项

1. **网络连接**：对话式占卜需要稳定的网络连接
2. **API配额**：确保DeepSeek API有足够的配额
3. **浏览器兼容**：推荐使用Chrome、Firefox、Safari最新版
4. **隐私**：所有占卜内容仅用于本次会话，不会永久存储

## 🤝 反馈与支持

如有问题或建议，请：
- 提交GitHub Issue
- 联系技术支持
- 查看完整文档

---

**愿塔罗的智慧照亮您的旅程！** ✨🔮


